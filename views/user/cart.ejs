<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
  <meta charset="utf-8">
  <title>Wander - eCommerce HTML Template</title>
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:title" content="">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content="">
  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="../user-assets/imgs/theme/favicon.svg">
  <!-- Template CSS -->
  <link rel="stylesheet" href="../user-assets/css/main.css?v=3.4">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

  <style>
    /* Footer Styling */
    footer.main {
      padding-top: 40px;
      padding-bottom: 40px;
    }

    .widget-about p {
      color: #a8a8a8;
      line-height: 1.8;
    }

    .social-icons a {
      display: inline-block;
      margin-right: 10px;
    }

    .widget-title {
      color: #fff;
      font-weight: bold;
    }

    .footer-list li {
      list-style: none;
    }

    .download-app img {
      max-width: 130px;
      margin-right: 10px;
      margin-bottom: 10px;
    }

    .font-sm {
      font-size: 14px;
    }

    .text-light {
      color: #fff !important;
    }

    .text-muted {
      color: #a8a8a8 !important;
    }

    .header-info-right ul li {
    display: inline;
    margin-left: 20px;
}

.header-info-right ul li:first-child {
    margin-left: 0;
}

.header-info-right a {
    text-decoration: none;
    color: #343a40; /* Adjust text color as needed */
}

.header-info-right a:hover {
    text-decoration: underline;
}

.header-info-right .fi-rs-user {
    margin-right: 5px;
}

  </style>
</head>

<body>
  <!-- Quick view -->

  <header class="header-area header-style-4 header-height-2">
    <div class="header-top header-top-ptb-1 d-none d-lg-block" style="background-color: #f8f9fa;">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-xl-3 col-lg-4">
            <div class="header-info">
              <!-- Your content here -->
            </div>
          </div>
          <div class="col-xl-6 col-lg-4">
            <div class="text-center">
              <!-- Your content here -->
            </div>
          </div>
          <div class="col-xl-3 col-lg-4">
            <div class="header-info header-info-right text-end">
                <ul class="list-inline mb-0">
                    <li class="list-inline-item">
                        <a class="language-dropdown-active text-dark" href="#"> <i class="fi-rs-world"></i> English</a>
                    </li>
                    <li class="list-inline-item">
                        <i class="fi-rs-user"></i>
                        <a href="/profile" class="text-black">
                          <%= user.name %>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a href="/logout">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
        
        </div>
      </div>
    </div>

    <div class="header-middle header-middle-ptb-1 d-none d-lg-block">
      <div class="container">
        <div class="header-wrap">
          <div class="logo logo-width-1">
            <a href="index.html"><img src="../user-assets/imgs/theme/logo.svg" alt="logo"></a>
          </div>
          <div class="header-right">
            <div class="search-style-2">
              <form action="#">
                <select class="select-active">
                  <option>All Categories</option>

                </select>
                <input type="text" placeholder="Search for items...">
              </form>
            </div>
            <div class="header-action-right">
              <div class="header-action-2">
                <div class="header-action-icon-2">
                  <a href="shop-wishlist.html">
                    <img class="svgInject" alt="Wander" src="../user-assets/imgs/theme/icons/icon-heart.svg">
                    <span class="pro-count blue">4</span>
                  </a>
                </div>
                <div class="header-action-icon-2">
                  <a class="mini-cart-icon" href="shop-cart.html">
                    <img alt="Wander" src="../user-assets/imgs/theme/icons/icon-cart.svg">
                    <span class="pro-count blue">2</span>
                  </a>

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="header-bottom header-bottom-bg-color sticky-bar">
      <div class="container">
        <div class="header-wrap header-space-between position-relative">
          <div class="logo logo-width-1 d-block d-lg-none">
            <a href="index.html"><img src="../user-assets/imgs/theme/logo.svg" alt="logo"></a>
          </div>

        </div>
      </div>
    </div>
  </header>




  <main class="main">
    <div class="page-header breadcrumb-wrap " style="background-color: #fff;">
      <div class="container">
          <div class="breadcrumb">
              <a href="/home" rel="nofollow" style="color: #000000;">Home</a>
              <span></span>
              <a href="/shop" rel="nofollow" style="color: #000000;">Shop</a>
              <span></span> My Cart
          </div>
      </div>
  </div>

  <section class="mt-5 mb-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="table-responsive shadow p-3 mb-5 bg-body rounded">
                    <table class="table shopping-summery text-center">
                        <thead>
                            <tr class="main-heading">
                                <th scope="col">Image</th>
                                <th scope="col">Product Name</th>
                                <th scope="col">Price</th>
                                <th scope="col">Quantity</th>
                                <th scope="col">Total</th>
                                <th scope="col">Remove</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if (cart && cart.items.length > 0) { %>
                            <% cart.items.forEach((item, index) => { %>
                            <tr id="item-<%= index + 1 %>">
                                <td class="image product-thumbnail"><img src="/productImages/<%= item.image[0] %>" alt="#" style="max-width: 100px;"></td>
                                <td class="product-des product-name">
                                    <h5><a href="#" class="text-dark"><%= item.title %></a></h5>
                                    <% if (item.productStatus === 'Limit-Exceeded') { %>
                                    <p class="font-xs text-danger" id="countInStock-<%= item._id %>">Maximum quantity limit reached</p>
                                    <% } else if (item.countInStock <= 0) { %>
                                    <p class="font-xs text-danger">Out of Stock</p>
                                    <% } else if (item.countInStock <= 10) { %>
                                    <p class="font-xs text-danger" id="countInStock-<%= item._id %>">Only <%= item.countInStock %> stocks Left</p>
                                    <% } else { %>
                                    <p class="font-xs text-info" id="countInStock-<%= item._id %>">In Stock</p>
                                    <% } %>
                                </td>
                                <td class="price" data-title="Price"><span>Rs.<%= item.productPrice %>/-</span></td>
                                <td class="text-center" data-title="Quantity" style="width: 200px;">
                                  <div class="d-flex justify-content-center align-items-center">
                                        <button class="btn btn-sm  btn-outline-secondary  decrease-quantity" data-id="<%= item._id %>">-</button>
                                        <input type="number" class="form-control black-border black-spin-buttons trendy-quantity-input text-center" value="<%= item.quantity %>" min="1" max="4" data-id="<%= item._id %>" readonly>
                                        <button class="btn btn-sm btn-outline-success  increase-quantity" data-id="<%= item._id %>">+</button>
                                    </div>
                                </td>
                                <td class="text-right subtotal" data-title="Total" id="price-<%= item._id %>">
                                    <span>Rs.<%= item.price %>/-</span>
                                </td>
                                <td class="action" data-title="Remove">
                                    <button class="btn btn-sm btn-danger remove-item" data-id="<%= item._id %>"><i class="fi-rs-trash"></i></button>
                                </td>
                            </tr>
                            <% }); %>
                            <tr>
                                <td colspan="6" class="text-end">
                                    <button class="btn btn-danger clear-cart"><i class="fi-rs-trash"></i> Clear Cart</button>
                                </td>
                            </tr>
                            <% } else { %>
                            <tr>
                                <td colspan="6" class="text-center">Your cart is empty</td>
                            </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
                <div class="cart-action text-end mb-4">
                    <button class="btn btn-secondary mr-2 update-cart"><i class="fi-rs-shuffle"></i> Update Cart</button>
                    <a href="#" class="btn btn-primary"><i class="fi-rs-shopping-bag"></i> Continue Shopping</a>
                </div>

                <div class="row">
                    <div class="col-lg-6 col-md-12 mx-auto">
                        <div class="border p-md-4 p-3 rounded cart-totals shadow">
                            <div class="heading_s1 mb-3">
                                <h4>Cart Totals</h4>
                            </div>
                            <div class="table-responsive">
                                <table class="table">
                                    <tbody>
                                        <tr>
                                            <td class="cart_total_label">Cart Subtotal</td>
                                            <td class="cart_total_amount"><span class="font-lg fw-bold text-brand" id="cart-subtotal"><%= cart ? `Rs.${cart.billTotal}/-` : 'Rs.0/-' %></span></td>
                                        </tr>
                                        <tr>
                                            <td class="cart_total_label">Shipping</td>
                                            <td class="cart_total_amount"><i class="ti-gift mr-1"></i> Free Shipping</td>
                                        </tr>
                                        <tr>
                                            <td class="cart_total_label">Total</td>
                                            <td class="cart_total_amount"><strong><span class="font-xl fw-bold text-brand" id="cart-total"><%= cart ? `Rs.${cart.billTotal}/-` : 'Rs.0/-' %></span></strong></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <a href="/checkout" class="btn btn-success"><i class="fi-rs-box-alt"></i> Proceed To Checkout</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>






















  </main>
  <footer class="main bg-secondary text-light">
    <section class="section-padding footer-mid">
      <div class="container pt-15 pb-20">
        <div class="row">
          <div class="col-lg-4 col-md-6">
            <div class="widget-about font-md mb-md-5 mb-lg-0">
              <div class="logo logo-width-1 wow fadeIn animated">
                <a href="index.html"><img src="../user-assets/imgs/theme/logo.svg" alt="logo"></a>
              </div>
              <h5 class="mt-20 mb-10 fw-600 text-grey-4 wow fadeIn animated">Contact</h5>
              <p class="wow fadeIn animated">
                <strong>Address: </strong>562 Wellington Road, Street 32, San Francisco
              </p>
              <p class="wow fadeIn animated">
                <strong>Phone: </strong>+01 2222 365 /(+91) 01 2345 6789
              </p>
              <p class="wow fadeIn animated">
                <strong>Hours: </strong>10:00 - 18:00, Mon - Sat
              </p>
              <h5 class="mb-10 mt-30 fw-600 text-grey-4 wow fadeIn animated">Follow Us</h5>
              <div class="mobile-social-icon wow fadeIn animated mb-sm-5 mb-md-0">
                <a href="#"><img src="../user-assets/imgs/theme/icons/icon-facebook.svg" alt=""></a>
                <a href="#"><img src="../user-assets/imgs/theme/icons/icon-twitter.svg" alt=""></a>
                <a href="#"><img src="../user-assets/imgs/theme/icons/icon-instagram.svg" alt=""></a>
                <a href="#"><img src="../user-assets/imgs/theme/icons/icon-pinterest.svg" alt=""></a>
                <a href="#"><img src="../user-assets/imgs/theme/icons/icon-youtube.svg" alt=""></a>
              </div>
            </div>
          </div>
          <div class="col-lg-2 col-md-3">
            <h5 class="widget-title wow fadeIn animated">About</h5>
            <ul class="footer-list wow fadeIn animated mb-sm-5 mb-md-0">
              <li><a href="#">About Us</a></li>
              <li><a href="#">Delivery Information</a></li>
              <li><a href="#">Privacy Policy</a></li>
              <li><a href="#">Terms &amp; Conditions</a></li>
              <li><a href="#">Contact Us</a></li>
              <li><a href="#">Support Center</a></li>
            </ul>
          </div>
          <div class="col-lg-2  col-md-3">
            <h5 class="widget-title wow fadeIn animated">My Account</h5>
            <ul class="footer-list wow fadeIn animated">
              <li><a href="#">Sign In</a></li>
              <li><a href="#">View Cart</a></li>
              <li><a href="#">My Wishlist</a></li>
              <li><a href="#">Track My Order</a></li>
              <li><a href="#">Help</a></li>
              <li><a href="#">Order</a></li>
            </ul>
          </div>
          <div class="col-lg-4">
            <h5 class="widget-title wow fadeIn animated">Install App</h5>
            <div class="row">
              <div class="col-md-8 col-lg-12">
                <p class="wow fadeIn animated">From App Store or Google Play</p>
                <div class="download-app wow fadeIn animated">
                  <a href="#" class="hover-up mb-sm-4 mb-lg-0"><img class="active"
                      src="../user-assets/imgs/theme/app-store.jpg" alt=""></a>
                  <a href="#" class="hover-up"><img src="../user-assets/imgs/theme/google-play.jpg" alt=""></a>
                </div>
              </div>
              <div class="col-md-4 col-lg-12 mt-md-3 mt-lg-0">
                <p class="mb-20 wow fadeIn animated">Secured Payment Gateways</p>
                <img class="wow fadeIn animated" src="../user-assets/imgs/theme/payment-method.png" alt="">
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <div class="container pb-20 wow fadeIn animated">
      <div class="row">
        <div class="col-12 mb-20">
          <div class="footer-bottom"></div>
        </div>
        <div class="col-lg-6">
          <p class="float-md-left font-sm text-muted mb-0">&copy; 2022, <strong class="text-brand">Wander</strong> -
            HTML Ecommerce Template </p>
        </div>
        <div class="col-lg-6">
          <p class="text-lg-end text-start font-sm text-muted mb-0">
            Designed by <a href="http://alithemes.com" target="_blank">Alithemes.com</a>. All rights reserved
          </p>
        </div>
      </div>
    </div>
  </footer>
  <!-- Preloader Start -->
  <div id="preloader-active">
    <div class="preloader d-flex align-items-center justify-content-center">
      <div class="preloader-inner position-relative">
        <div class="text-center">
          <h5 class="mb-5">Now Loading</h5>
          <div class="loader">
            <div class="bar bar1"></div>
            <div class="bar bar2"></div>
            <div class="bar bar3"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Vendor JS-->
  <script src="../user-assets/js/vendor/modernizr-3.6.0.min.js"></script>
  <script src="../user-assets/js/vendor/jquery-3.6.0.min.js"></script>
  <script src="../user-assets/js/vendor/jquery-migrate-3.3.0.min.js"></script>
  <script src="../user-assets/js/vendor/bootstrap.bundle.min.js"></script>
  <script src="../user-assets/js/plugins/slick.js"></script>
  <script src="../user-assets/js/plugins/jquery.syotimer.min.js"></script>
  <script src="../user-assets/js/plugins/wow.js"></script>
  <script src="../user-assets/js/plugins/jquery-ui.js"></script>
  <script src="../user-assets/js/plugins/perfect-scrollbar.js"></script>
  <script src="../user-assets/js/plugins/magnific-popup.js"></script>
  <script src="../user-assets/js/plugins/select2.min.js"></script>
  <script src="../user-assets/js/plugins/waypoints.js"></script>
  <script src="../user-assets/js/plugins/counterup.js"></script>
  <script src="../user-assets/js/plugins/jquery.countdown.min.js"></script>
  <script src="../user-assets/js/plugins/images-loaded.js"></script>
  <script src="../user-assets/js/plugins/isotope.js"></script>
  <script src="../user-assets/js/plugins/scrollup.js"></script>
  <script src="../user-assets/js/plugins/jquery.vticker-min.js"></script>
  <script src="../user-assets/js/plugins/jquery.theia.sticky.js"></script>
  <script src="../user-assets/js/plugins/jquery.elevatezoom.js"></script>
  <!-- Template  JS -->
  <script src="./../user-assets/js/main.js?v=3.4"></script>
  <script src="./../user-assets/js/shop.js?v=3.4"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

  <script>
  
// Function to display success message
function showSuccessMessage(message) {
    Swal.fire({
        icon: 'success',
        title: 'Success',
        text: message
    });
}

// Function to display confirmation message
function showConfirmationMessage(message, callback) {
    Swal.fire({
        title: 'Are you sure?',
        text: message,
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!'
    }).then((result) => {
        if (result.isConfirmed) {
            callback();
        }
    });
}

// Function to display error message
function showErrorMessage(message) {
    Swal.fire({
        icon: 'error',
        title: 'Error',
        text: message
    });
}

  const quantityInputs = document.querySelectorAll('.trendy-quantity-input');
  quantityInputs.forEach(input => {
      const decreaseBtn = input.parentNode.querySelector('.decrease-quantity');
      const increaseBtn = input.parentNode.querySelector('.increase-quantity');

      decreaseBtn.addEventListener('click', () => updateQuantity(input, -1));
      increaseBtn.addEventListener('click', () => updateQuantity(input, 1));
  });

  // Add event listener for remove item buttons
  const removeButtons = document.querySelectorAll('.remove-item');
  removeButtons.forEach(button => {
      button.addEventListener('click', () => removeItem(button.dataset.id));
  });

  // Add event listener for update cart button
  const updateCartBtn = document.querySelector('.update-cart');
  updateCartBtn.addEventListener('click', updateCart);

  // Add event listener for clear cart button
  const clearCartBtn = document.querySelector('.clear-cart');
  clearCartBtn.addEventListener('click', clearCart);

  function updateQuantity(input, change) {
      const productId = input.dataset.id;
      const currentQuantity = parseInt(input.value);
      const newQuantity = currentQuantity + change;

      if (newQuantity >= 1 && newQuantity <= 5) {
          fetch(`/cart/update/${productId}`, {
              method: 'PUT',
              headers: {
                  'Content-Type': 'application/json'
              },
              body: JSON.stringify({ quantity: newQuantity })
          })
          .then(response => response.json())
          .then(data => {
              if (data.success) {
                  input.value = newQuantity;
                  const priceElement = document.getElementById(`price-${productId}`);
                  priceElement.querySelector('span').textContent = `Rs.${data.newPrice}/-`;
                  updateTotals();
                showAlert(data.message, 'success');
              
              } else {
                  showAlert(data.message, 'error');
                 
              }
          })
          .catch(error => {
              console.error('Error updating quantity:', error);
             showAlert('An error occurred while updating the quantity.', 'error');
            
          });
      } else {
          showAlert('Quantity must be between 1 and 5.', 'error');
         
      }
  }

  function removeItem(productId) {
    showConfirmationMessage('Are you sure you want to remove this item?', () => {
      fetch(`/cart/remove/${productId}`, {
          method: 'DELETE'
      })
      .then(response => response.json())
      .then(data => {
          if (data.success) {
              const itemRow = document.querySelector(`#item-${data.itemIndex}`);
              itemRow.remove();
              updateTotals();
             
              showAlert(data.message, 'success');
          } else {
              showAlert(data.message, 'error');
           
          }
      })
      .catch(error => {
          console.error('Error removing item:', error);
          showAlert('An error occurred while removing the item from the cart.', 'error');
          
      });
    })
  }

  function updateCart() {
      fetch('/cart/update', {
          method: 'PUT'
      })
      .then(response => response.json())
      .then(data => {
          if (data.success) {
              updateTotals();
              showAlert(data.message, 'success');
              data.updatedItems.forEach(item => {
                  const itemRow = document.querySelector(`#item-${item.itemIndex}`);
                  const priceElement = itemRow.querySelector('.subtotal span');
                  const countInStockElement = itemRow.querySelector('#countInStock-' + item.productId);
                  priceElement.textContent = `Rs.${item.price}/-`;
                  if (item.productStatus === 'Limit-Exceeded') {
                      countInStockElement.textContent = 'Maximum quantity limit reached';
                      countInStockElement.classList.remove('text-danger', 'text-info');
                      countInStockElement.classList.add('text-danger');
                  } else if (item.countInStock <= 0) {
                      countInStockElement.textContent = 'Out of Stock';
                      countInStockElement.classList.remove('text-danger', 'text-info');
                      countInStockElement.classList.add('text-danger');
                  } else if (item.countInStock <= 10) {
                      countInStockElement.textContent = `Only ${item.countInStock} stocks Left`;
                      countInStockElement.classList.remove('text-danger', 'text-info');
                      countInStockElement.classList.add('text-danger');
                  } else {
                      countInStockElement.textContent = 'In Stock';
                      countInStockElement.classList.remove('text-danger', 'text-info');
                      countInStockElement.classList.add('text-info');
                  }
              });
          } else {
              showAlert(data.message, 'error');
          }
      })
      .catch(error => {
          console.error('Error updating cart:', error);
          showAlert('An error occurred while updating the cart.', 'error');
      });
  }

  function clearCart() {
    showConfirmationMessage('Are you sure you want to clear the cart?', () => {
      fetch('/cart/clear', {
          method: 'DELETE'
      })
      .then(response => response.json())
      .then(data => {
          if (data.success) {
              const itemRows = document.querySelectorAll('tr[id^="item-"]');
              itemRows.forEach(row => row.remove());
              updateTotals();
              showAlert(data.message, 'success');
          } else {
              showAlert(data.message, 'error');
          }
      })
      .catch(error => {
          console.error('Error clearing cart:', error);
          showAlert('An error occurred while clearing the cart.', 'error');
      });
    })
  }

  function updateTotals() {
      fetch('/cart/totals')
      .then(response => response.json())
      .then(data => {
          if (data.success) {
              const cartSubtotalElement = document.getElementById('cart-subtotal');
              const cartTotalElement = document.getElementById('cart-total');

              cartSubtotalElement.textContent = `Rs.${data.billTotal}/-`;
              cartTotalElement.textContent = `Rs.${data.billTotal}/-`;
          } else {
              showAlert('An error occurred while updating the cart totals.', 'error');
          }
      })
      .catch(error => {
          console.error('Error updating totals:', error);
          showAlert('An error occurred while updating the cart totals.', 'error');
      });
  }

  function showAlert(message, type) {
      Swal.fire({
          icon: type,
          title: type === 'success' ? 'Success' : 'Error',
          text: message
      });
  }
  </script>

</body>

</html>